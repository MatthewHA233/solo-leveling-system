{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Agent Report",
  "description": "客户端上报的感知数据",
  "type": "object",
  "required": ["device_id", "timestamp", "snapshot"],
  "properties": {
    "device_id": {
      "type": "string",
      "description": "设备唯一标识",
      "pattern": "^(mac|win|android)-[a-z0-9]{8}$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO8601 时间戳"
    },
    "snapshot": {
      "type": "object",
      "required": ["active_window", "idle_seconds", "is_screen_locked"],
      "properties": {
        "screenshot_b64": {
          "type": "string",
          "description": "Base64 编码的 JPEG 截图"
        },
        "active_window": {
          "type": "object",
          "properties": {
            "app_name": { "type": "string" },
            "window_title": { "type": "string" },
            "bundle_id": { "type": "string" }
          }
        },
        "idle_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "距上次用户输入的秒数"
        },
        "is_screen_locked": {
          "type": "boolean"
        },
        "battery_level": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "network_type": {
          "type": "string",
          "enum": ["wifi", "ethernet", "cellular", "none"]
        }
      }
    }
  }
}
